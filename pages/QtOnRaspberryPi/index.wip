
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7 ie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8 ie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9 ie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Qt On Raspberry Pi</title>
	<meta name="author" content="JH">
	<link href='http://jheyman.github.io/blog/assets/themes/mytheme/css/style.css' rel="stylesheet" media="all">
	<link href="http://feeds.feedburner.com/" rel="alternate" title="Qt On Raspberry Pi" type="application/atom+xml">
	<script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.0.6/modernizr.min.js"></script>
</head>
<body>

<div id="page" class="hentry">
	<header class="the-header">
		<div class="unit-head">
			<div class="unit-inner unit-head-inner">
				<a href="http://jheyman.github.io/blog/index.html"><img src="http://jheyman.github.io/blog/assets/images/common/hotglue_and_homemade_bits.png" height="100%" class="center" /></a>
			</div><!-- unit-inner -->
		</div><!-- unit-head -->
	</header>
	<div class="body" role="main">
		<div class="unit-body">
			<div class="unit-inner unit-body-inner">
				<div class="entry-content">
					
<article class="unit-article layout-page">
	<div class="unit-inner unit-article-inner">
		<div class="content">
			<header>
				<div class="unit-head">
					<div class="unit-inner unit-head-inner">
						<h1 class="h2 entry-title">Qt On Raspberry Pi</h1>
					</div><!-- unit-inner -->
				</div><!-- unit-head -->
			</header>

			<div class="bd">
				<div class="entry-content">
					


# COMING SOON !
<!--
## Overview

xxxxx


* TOC
{:toc}



All taken from [this page](https://wiki.qt.io/RaspberryPi2EGLFS#Qt_Creator), but captured here since I tweaked a few things and want to make sure I can redo this install whenever.

I chose to install Qt5.10, on a Raspberry Pi3 Model B+, installed with a Raspbian Stretch desktop image (2018-03-13-raspbian-stretch.img), and am using a Linux host running Ubuntu 16.04 LTS

[Host PC] sudo dd if=2018-03-13-raspbian-stretch.img of=... bs=4M
[RPi] Boot to desktop. From the settings menu, I changed the GPU memory to 256 MB.
[RPi] sudo rpi-update
[RPi] reboot
[RPi] sudo nano /etc/apt/sources.list
[RPi] uncomment the deb-src line, and save.
[RPi] sudo apt-get update
[RPi] sudo apt-get build-dep qt4-x11
[RPi] sudo apt-get build-dep libqt5gui5
[RPi] sudo apt-get install libudev-dev libinput-dev libts-dev libxcb-xinerama0-dev libxcb-xinerama0
[RPi] sudo mkdir /usr/local/qt5pi
[RPi] sudo chown pi:pi /usr/local/qt5pi

[Host PC] mkdir ~/raspi
[Host PC] cd ~/raspi
[Host PC] git clone https://github.com/raspberrypi/tools
[Host PC] mkdir sysroot sysroot/usr sysroot/opt
[Host PC] rsync -avz pi@raspberrypi.local:/lib sysroot
[Host PC] rsync -avz pi@raspberrypi.local:/usr/include sysroot/usr
[Host PC] rsync -avz pi@raspberrypi.local:/usr/lib sysroot/usr
[Host PC] rsync -avz pi@raspberrypi.local:/opt/vc sysroot/opt
[Host PC] wget https://raw.githubusercontent.com/riscv/riscv-poky/priv-1.10/scripts/sysroot-relativelinks.py
[Host PC] chmod +x sysroot-relativelinks.py
[Host PC] ./sysroot-relativelinks.py sysroot
[Host PC] wget http://download.qt.io/official_releases/qt/5.7/5.7.0/single/qt-everywhere-opensource-src-5.7.0.tar.xz
[Host PC] tar xf qt-everywhere-opensource-src-5.7.0.tar.gz
[Host PC] cd qt-everywhere-opensource-src-5.7.0

[Host PC] cd qt-everywhere-src-5.10.1
[Host PC] ./configure -release -skip qtwayland -skip qtlocation -nomake tests -nomake examples -opengl es2 -device linux-rasp-pi3-g++ -device-option CROSS_COMPILE=~/raspi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin/arm-linux-gnueabihf- -sysroot ~/raspi/sysroot -opensource -confirm-license -make libs -prefix /usr/local/qt5pi -extprefix ~/raspi/qt5pi -hostprefix ~/raspi/qt5 -v -no-use-gold-linker



Note: skip QtWayland build to avoid error :

In file included from ../../../../hardwareintegration/compositor/brcm-egl/brcmeglintegration.cpp:55:0:
/home/etabli/raspi/sysroot/opt/vc/include/GLES2/gl2.h:600:125: error: declaration of C function ‘void glShaderSource(GLuint, GLsizei, const GLchar**, const GLint*)’ conflicts with
 GL_APICALL void         GL_APIENTRY glShaderSource (GLuint shader, GLsizei count, const GLchar** string, const GLint* length);
                                                                                                                             ^
In file included from /home/etabli/qt-everywhere-src-5.10.1/qtbase/include/QtGui/../../src/gui/opengl/qopengl.h:105:0,
                 from /home/etabli/qt-everywhere-src-5.10.1/qtbase/include/QtGui/qopengl.h:1,
                 from ../../../../../include/QtWaylandCompositor/../../src/compositor/compositor_api/qwaylandbufferref.h:47,
                 from ../../../../../include/QtWaylandCompositor/qwaylandbufferref.h:1,
                 from ../../../../../include/QtWaylandCompositor/5.10.1/QtWaylandCompositor/private/../../../../../src/compositor/hardware_integration/qwlclientbufferintegration_p.h:56,
                 from ../../../../../include/QtWaylandCompositor/5.10.1/QtWaylandCompositor/private/qwlclientbufferintegration_p.h:1,
                 from ../../../../hardwareintegration/compositor/brcm-egl/brcmeglintegration.h:43,
                 from ../../../../hardwareintegration/compositor/brcm-egl/brcmeglintegration.cpp:40:
/home/etabli/raspi/sysroot/usr/include/GLES3/gl32.h:621:29: error: previous declaration ‘void glShaderSource(GLuint, GLsizei, const GLchar* const*, const GLint*)’ here
 GL_APICALL void GL_APIENTRY glShaderSource (GLuint shader, GLsizei count, const GLchar *const*string, const GLint *length);)





[Host PC] make -j4 all
[Host PC] make install
(plus trop sur si le sudo est requis ou non)
[Host PC] cd ~/raspi
[Host PC] rsync -avz qt5pi pi@raspberrypi.local:/usr/local


[RPi] echo /usr/local/qt5pi/lib | sudo tee /etc/ld.so.conf.d/00-qt5pi.conf
[RPi] sudo ldconfig
[RPi] sudo mv /usr/lib/arm-linux-gnueabihf/libEGL.so.1.0.0 /usr/lib/arm-linux-gnueabihf/libEGL.so.1.0.0_backup
[RPi] sudo mv /usr/lib/arm-linux-gnueabihf/libGLESv2.so.2.0.0 /usr/lib/arm-linux-gnueabihf/libGLESv2.so.2.0.0_backup
[RPi] sudo ln -s /opt/vc/lib/libEGL.so /usr/lib/arm-linux-gnueabihf/libEGL.so.1.0.0
[RPi] sudo ln -s /opt/vc/lib/libGLESv2.so /usr/lib/arm-linux-gnueabihf/libGLESv2.so.2.0.0
[RPi] sudo ln -s /opt/vc/lib/libEGL.so /opt/vc/lib/libEGL.so.1
[RPi] sudo ln -s /opt/vc/lib/libGLESv2.so /opt/vc/lib/libGLESv2.so.2

to build additional modules if needed:

[Host PC] git clone git://code.qt.io/qt/<qt-module>.git -b <qt-version>
[Host PC] cd <qt-module>
[Host PC] ~/raspi/qt5/bin/qmake -r
[Host PC] make
[Host PC] sudo make install
[Host PC] rsync -avz qt5pi pi@raspberrypi.local:/usr/local





Troubleshooting:
en cas d'erreur côté host du type 
libperl5.22 : Depends: perl-modules-5.22 (>= 5.22.1-9ubuntu0.2) but 5.22.1-9 is to be installed
alors cette action a corrigé le pb:
sudo apt-get  install --reinstall perl-modules-5.22



QTCreator setup ([this](https://www.ics.com/blog/configuring-qt-creator-raspberry-pi) page explains it all)

Go to Options -> Devices
  Add
    Generic Linux Device
    Enter IP address, user & password
    Finish
Go to Options -> Compilers
  Add
    GCC
    Compiler path: ~/raspi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian/bin/arm-linux-gnueabihf-g++
Go to Options -> Debuggers
  Add
    ~/raspi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin/arm-linux-gnueabihf-gdb
Go to Options -> Qt Versions
  Check if an entry with ~/raspi/qt5/bin/qmake shows up. If not, add it.
  
Go to Options -> Build & Run
  Kits
    Add
      Generic Linux Device
      Device: the one we just created
      Sysroot: ~/raspi/sysroot
      Compiler: the one we just created
      Debugger: the one we just created
      Qt version: the one we saw under Qt Versions
      Qt mkspec: leave empty


INSTALLS        = target
target.files    = widgettest
target.path     = /home/pi


 À la fin du fichier  .pro du projet. 




Compilation de Virtual Keyboard:

https://stackoverflow.com/questions/42576436/how-to-use-the-qtvirtualkeyboard

=> dans QtCreator, naviguer vers qt-everywhere / .... / qtvirtualkeyboard, ouvrir virtualkeyboard.pro, configurer la compi pour Raspi / release, builder.

puis copier à la main:

- tout le répertoire [...]/build-qtvirtualkeyboard-Raspi3_Homehub-Debug/qml/QtQuick/VirtualKeyboard 
vers ~/raspi/qt5pi/qml/QtQuick
- le fichier /home/etabli/qt-everywhere-src-5.10.1/build-qtvirtualkeyboard-Raspi3_Homehub-Debug/plugins/platforminputcontexts/libqtvirtualkeyboardplugin.so
vers ~/raspi/qt5pi/plugins/platforminputcontexts

=> lancement OK sur cible et clavier virtuel OK! (mais compil tjs KO sur Desktop)

Passage du clavier en français:

- ajout de l'option CONFIG+=lang-all dans les options supplémentaires qmake dans QtCreator pour ce projet
- sync/reinstall virtual keyboard sur raspi
- dans le code qml main, ajout de :

        Component.onCompleted: {
            VirtualKeyboardSettings.locale = "fr_FR";
        }


---

## title


![image](http://jheyman.github.io/blog/assets/images/QtOnRaspberryPi/image.png)


---


## Misc notes

* wwww 

---

## Lessons learned (so far)

* xx


!-->
				</div><!-- entry-content -->

				<br>
				<hr>
				<div class="misc-content">			
					


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jheymantechblog'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




				</div><!-- misc-content -->				
			</div><!-- bd -->

			<footer class="unit-foot">
				<div class="unit-inner unit-foot-inner">
					<p class="gotop">
						<a href="#page">Back to Top</a>
					</p>
				</div>
			</footer>

		</div><!-- content -->
	</div><!-- unit-inner -->
</article>


				</div>
			</div><!-- unit-inner -->
		</div><!-- unit-body -->
	</div><!-- body -->
	<footer class="the-footer">
		<div class="unit-foot">
			<div class="unit-inner unit-foot-inner">
				<div class="misc vcard">
					<h4>about</h4>
					<ul>
						<li class="contact"><address><span class="author fn n">JH</span> - <span class="fn email">bidsomail at gmail.com</span></address></li>
						<li>Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a>, theme based on the_minimum from <a href="http://jekyllbootstrap.com/">Jekyll-bootstrap</a></li>
					</ul>
				</div><!-- misc -->
			</div><!-- unit-foot-inner -->
		</div><!-- unit-foot -->
	</footer>
</div><!-- page -->
<script>
	(function(d, s) {
		var js, fjs = d.getElementsByTagName(s)[0], load = function(url, id) {
		if (d.getElementById(id)) {return;}
		js = d.createElement(s); js.src = url; js.id = id;
		fjs.parentNode.insertBefore(js, fjs);
		};
	load('//platform.twitter.com/widgets.js', 'tweetjs');
	// load('https://apis.google.com/js/plusone.js', 'gplus1js'); // Checkout http://j.mp/ApDgMr for usage html for this is <div class="g-plusone" data-size="medium"></div>
	// load('//connect.facebook.net/en_US/all.js#xfbml=1', 'fbjssdk'); // Checkout http://j.mp/wZw2xR for using open graph protorol html for this is <div class="fb-like" data-href="/pages/QtOnRaspberryPi/index.wip" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-font="verdana"></div>
	}(document, 'script'));
</script>
<script>
/*! A fix for the iOS orientationchange zoom bug.Script by @scottjehl, rebound by @wilto. MIT License.*/
(function(j){var i=j.document;if(!i.querySelectorAll){return}var l=i.querySelectorAll("meta[name=viewport]")[0],a=l&&l.getAttribute("content"),h=a+", maximum-scale=1.0",d=a+", maximum-scale=10.0",g=true,c=j.orientation,k=0;if(!l){return}function f(){l.setAttribute("content",d);g=true}function b(){l.setAttribute("content",h);g=false}function e(m){c=Math.abs(j.orientation);k=Math.abs(m.gamma);if(k>8&&c===0){if(g){b()}}else{if(!g){f()}}}j.addEventListener("orientationchange",f,false);j.addEventListener("deviceorientation",e,false)})(this);
</script>

  


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-43264312-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



</body>
</html>

